----------------------------------------------------------------
            sw4 version 1.1

 This program comes with ABSOLUTELY NO WARRANTY; released under GPL.
 This is free software, and you are welcome to redistribute     
 it under certain conditions, see LICENSE.txt for more details  
----------------------------------------------------------------
  Compiled on: Mon Nov 12 16:32:09 PST 2018
  By user:     bjorn
  Machine:     quartz1532
  Compiler:    /usr/tce/packages/impi/impi-2018.0-intel-18.0.1/bin/mpicxx
  3rd party include dir: /usr/apps/wpp/include, and library dir: /usr/apps/wpp/lib
----------------------------------------------------------------

Input file: /g/g91/bjorn/codes/sw4/inverse/pytest/reference/gradtest/grad.in
Default Supergrid thickness has been tuned; # grid points = 13 grid sizes
Default Supergrid damping coefficient has been tuned; damping coefficient = 0.015

* Processing the grid command...
	Warning: ignoring grid line option 'ghostpts=2'
* Setting nx to 176 to be consistent with h=200
* Setting ny to 176 to be consistent with h=200
* Setting nz to 99 to be consistent with h=200
* Changing z from 19500 to 19600 to be consistent with h=200
Extent of the computational domain xmax=35000 ymax=35000 zmax=19600

*** No topography command found in input file. Using z=0 as free surface boundary ***


Global grid sizes (without ghost points)
Grid         h        Nx        Ny        Nz       Points
   0       200       176       176        99      3066624
Total number of grid points (without ghost points): 3.06662e+06



   Execution time, reading input file 0.173333 seconds 
  Using Bjorn's fast (parallel) IO library
Assuming a SERIAL file system.
Detected at least one boundary with supergrid conditions
----------------------------------------------------
 Making Directory: run1/
		
... Done!
----------------------------------------------------
Geographic and Cartesian coordinates of the corners of the computational grid:
0: Lon= -1.180000e+02, Lat=3.700000e+01, x=0.000000e+00, y=0.000000e+00
1: Lon= -1.180000e+02, Lat=3.731441e+01, x=3.500000e+04, y=0.000000e+00
2: Lon= -1.176047e+02, Lat=3.731441e+01, x=3.500000e+04, y=3.500000e+04
3: Lon= -1.176063e+02, Lat=3.700000e+01, x=0.000000e+00, y=3.500000e+04

Considering all material blocks
block command: outside = 0, material = 3190528

       ----------- Material properties ranges ---------------
       2650 kg/m^3 <=  Density <= 2650 kg/m^3
       4630.76 m/s    <=  Vp      <= 4630.76 m/s
       2437.56 m/s    <=  Vs      <= 2437.56 m/s
       1.89975        <=  Vp/Vs   <= 1.89975
       1.57455e+10 Pa     <=  mu      <= 1.57455e+10 Pa
       2.53354e+10 Pa     <=  lambda  <= 2.53354e+10 Pa
       ------------------------------------------------------

***** PPW = minVs/h/maxFrequency ********
g=0, h=2.000000e+02, minVs/h=12.1878 (Cartesian)

  Assigned material properties
*** computing the time step ***
TIME accuracy order=4 CFL=1.1 prel. time step=0.0381085
*** Initialized Images
 Min source z-level: 2.000000e+03, max source z-level: 2.000000e+03

   Execution time, start up phase 0.0168011 seconds 
Running sw4mopt on 32 processors...
Writing output to directory: run1/
 xmin, xmax = 2800 32200 hx = 14700
 ymin, ymax = 2800 32200 hy = 14700
 zmin, zmax = -16800 16800 hz = 16800
2650 <=   rho    <= 2911.41 (grid 0)
1.57455e+10 <=    mu    <= 1.72987e+10 (grid 0)
2.53354e+10 <=  lambda  <= 2.78346e+10 (grid 0)
 cfl_max = 1.10078 on grid 0
Maximum temporary file size on grid 0 is 28224 doubles for each time step 
number of grid point  sources = 216
number of unique g.p. sources = 216

Reporting SW4 internal flags and settings:
m_testing=no, twilight=no, point_source=no, moment_test=no, energy_test=no, lamb_test=no, rayleigh_test=no
m_use_supergrid=yes
End report of internal flags and settings


   Execution time, initial data phase 0.0110819 seconds 

   Execution time, time stepping phase 23.9054 seconds 
number of grid point  sources = 216
number of unique g.p. sources = 216
Grid nr. 0: 
   Max norm of backed out U  = 3.73559e-13 3.73989e-13 1.58733e-13
   Max norm of backed out Um = 3.61244e-13 3.6101e-13 1.56425e-13
Initial f = 3.52667 
Gradient testing shared parameters :
2650 <=   rho    <= 2911.41 (grid 0)
1.57455e+10 <=    mu    <= 1.72987e+10 (grid 0)
2.53354e+10 <=  lambda  <= 2.78346e+10 (grid 0)
 cfl_max = 1.10078 on grid 0
number of grid point  sources = 216
number of unique g.p. sources = 216

Reporting SW4 internal flags and settings:
m_testing=no, twilight=no, point_source=no, moment_test=no, energy_test=no, lamb_test=no, rayleigh_test=no
m_use_supergrid=yes
End report of internal flags and settings


   Execution time, initial data phase 0.00981593 seconds 

   Execution time, time stepping phase 7.65691 seconds 
 ind = 0f = 3.52667 h= 7.95e-05 dfan = -0.00507806 dfnum = -0.00507796 err = -9.45441e-08
2650 <=   rho    <= 2911.41 (grid 0)
1.57455e+10 <=    mu    <= 1.72987e+10 (grid 0)
2.53354e+10 <=  lambda  <= 2.78346e+10 (grid 0)
 cfl_max = 1.10078 on grid 0
number of grid point  sources = 216
number of unique g.p. sources = 216

Reporting SW4 internal flags and settings:
m_testing=no, twilight=no, point_source=no, moment_test=no, energy_test=no, lamb_test=no, rayleigh_test=no
m_use_supergrid=yes
End report of internal flags and settings


   Execution time, initial data phase 0.00971508 seconds 

   Execution time, time stepping phase 7.6626 seconds 
 ind = 1f = 3.52668 h= 462 dfan = 5.02768e-09 dfnum = 5.0277e-09 err = -1.60281e-14
Done ind = 1
2650 <=   rho    <= 2911.41 (grid 0)
1.57455e+10 <=    mu    <= 1.72987e+10 (grid 0)
2.53354e+10 <=  lambda  <= 2.78346e+10 (grid 0)
 cfl_max = 1.10078 on grid 0
number of grid point  sources = 216
number of unique g.p. sources = 216

Reporting SW4 internal flags and settings:
m_testing=no, twilight=no, point_source=no, moment_test=no, energy_test=no, lamb_test=no, rayleigh_test=no
m_use_supergrid=yes
End report of internal flags and settings


   Execution time, initial data phase 0.0098989 seconds 

   Execution time, time stepping phase 7.69306 seconds 
 ind = 2f = 3.52667 h= 22560 dfan = -1.25936e-12 dfnum = -1.25902e-12 err = -3.39371e-16
Done ind = 2
============================================================
 sw4mopt ( Material/Source estimation solver) finished! 
============================================================
