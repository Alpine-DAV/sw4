----------------------------------------------------------------
            sw4 version 2.2-alpha

 This program comes with ABSOLUTELY NO WARRANTY; released under GPL.
 This is free software, and you are welcome to redistribute     
 it under certain conditions, see LICENSE.txt for more details  
----------------------------------------------------------------
  Compiled on: Sun Dec 16 13:41:09 PST 2018
  By user:     andersp
  Machine:     quartz380
  Compiler:    /usr/tce/packages/impi/impi-2019.0-intel-18.0.2/bin/mpicxx
  3rd party include dir: /usr/apps/wpp/include, and library dir: /usr/apps/wpp/lib
----------------------------------------------------------------

Input file: inv.in

* Processing the grid command...
* Setting nx to 176 to be consistent with h=200
* Setting ny to 176 to be consistent with h=200
* Setting nz to 99 to be consistent with h=200
* Changing z from 19500 to 19600 to be consistent with h=200
Extent of the computational domain xmax=35000 ymax=35000 zmax=19600

*** No topography command found in input file. Using z=0 as free surface boundary ***


Global grid sizes (without ghost points)
Grid         h        Nx        Ny        Nz       Points
   0       200       176       176        99      3066624
Total number of grid points (without ghost points): 3.06662e+06



   Execution time, reading input file 0.145532 seconds 
  Using Bjorn's fast (parallel) IO library
Assuming a SERIAL file system.
Detected at least one boundary with supergrid conditions
----------------------------------------------------
 Making Directory: run1/
		
... Done!
----------------------------------------------------
Geographic and Cartesian coordinates of the corners of the computational grid:
0: Lon= -1.180000e+02, Lat=3.700000e+01, x=0.000000e+00, y=0.000000e+00
1: Lon= -1.180000e+02, Lat=3.731441e+01, x=3.500000e+04, y=0.000000e+00
2: Lon= -1.176047e+02, Lat=3.731441e+01, x=3.500000e+04, y=3.500000e+04
3: Lon= -1.176063e+02, Lat=3.700000e+01, x=0.000000e+00, y=3.500000e+04

Considering all material blocks
block command: outside = 0, material = 3190528

       ----------- Material properties ranges ---------------
       2650 kg/m^3 <=  Density <= 2650 kg/m^3
       4630.76 m/s    <=  Vp      <= 4630.76 m/s
       2437.56 m/s    <=  Vs      <= 2437.56 m/s
       1.89975        <=  Vp/Vs   <= 1.89975
       1.57455e+10 Pa     <=  mu      <= 1.57455e+10 Pa
       2.53354e+10 Pa     <=  lambda  <= 2.53354e+10 Pa
       ------------------------------------------------------

***** PPW = minVs/h/maxFrequency ********
g=0, h=2.000000e+02, minVs/h=12.1878 (Cartesian)

  Assigned material properties
*** computing the time step ***
TIME accuracy order=4 CFL=1.1 prel. time step=0.0381085
*** Initialized Images
 Min source z-level: 2.000000e+03, max source z-level: 2.000000e+03

   Execution time, start up phase 0.00814104 seconds 
 xmin, xmax = 6200 28800 hx = 11300
 ymin, ymax = 6200 28800 hy = 11300
 zmin, zmax = -13400 13400 hz = 13400
----------------------------------------------------
 Making Directory: run1/
		
... Done!
----------------------------------------------------
Running sw4mopt on 144 processors...
Writing output to directory: run1/
Begin L-BFGS iteration by evaluating initial misfit and gradient...
Initial misfit= 2.934
Max norm of scaled total gradient = 60.833
Line search.. 
After constraining the material, lambda (scalefactor for step length) = 0.0823543 ntries = 8
 step failed for lambda = 0.0823543 ... trying new lambda = 0.0256762
 step failed for lambda = 0.0256762 ... trying new lambda = 0.00256762
 step failed for lambda = 0.00256762 ... trying new lambda = 0.000367451
 .. return code 0 misfit changed from 2.934 to 2.8209
-----------------------------------------------------------------------
 it=1 max-norm scaled gradient= 48.0367 max-norm model update= 0.00364266
 Misfit= 2.8209
Line search.. 
After constraining the material, lambda (scalefactor for step length) = 0.0197733 ntries = 12
 step failed for lambda = 0.0197733 ... trying new lambda = 0.00988663
 .. return code 0 misfit changed from 2.8209 to 2.01759
-----------------------------------------------------------------------
 it=2 max-norm scaled gradient= 134.851 max-norm model update= 0.0692258
 Misfit= 2.01759
Line search.. 
After constraining the material, lambda (scalefactor for step length) = 0.0282475 ntries = 11
 step failed for lambda = 0.0282475 ... trying new lambda = 0.0141238
 step failed for lambda = 0.0141238 ... trying new lambda = 0.00706188
 .. return code 0 misfit changed from 2.01759 to 0.411604
-----------------------------------------------------------------------
 it=3 max-norm scaled gradient= 83.3687 max-norm model update= 0.0496993
 Misfit= 0.411604
Line search.. 
 step failed for lambda = 1 ... trying new lambda = 0.369581
 .. return code 0 misfit changed from 0.411604 to 0.0622761
-----------------------------------------------------------------------
 it=4 max-norm scaled gradient= 11.4867 max-norm model update= 0.00569716
 Misfit= 0.0622761
Line search.. 
 .. return code 0 misfit changed from 0.0622761 to 0.00106235
-----------------------------------------------------------------------
 it=5 max-norm scaled gradient= 1.83917 max-norm model update= 0.0151662
 Misfit= 0.00106235
Line search.. 
 .. return code 0 misfit changed from 0.00106235 to 1.51279e-05
-----------------------------------------------------------------------
 it=6 max-norm scaled gradient= 0.513363 max-norm model update= 0.0017933
 Misfit= 1.51279e-05
Line search.. 
 .. return code 0 misfit changed from 1.51279e-05 to 7.2797e-06
-----------------------------------------------------------------------
 it=7 max-norm scaled gradient= 0.16884 max-norm model update= 3.8963e-05
 Misfit= 7.2797e-06
Line search.. 
 .. return code 0 misfit changed from 7.2797e-06 to 6.38995e-06
-----------------------------------------------------------------------
 it=8 max-norm scaled gradient= 0.00470442 max-norm model update= 9.97908e-06
 Misfit= 6.38995e-06
Line search.. 
 .. return code 0 misfit changed from 6.38995e-06 to 6.38921e-06
-----------------------------------------------------------------------
 it=9 max-norm scaled gradient= 0.00104399 max-norm model update= 5.32933e-07
 Misfit= 6.38921e-06
Line search.. 
 .. return code 0 misfit changed from 6.38921e-06 to 6.38918e-06
-----------------------------------------------------------------------
 it=10 max-norm scaled gradient= 2.9034e-07 max-norm model update= 1.03682e-07
 Misfit= 6.38918e-06
============================================================
 sw4mopt ( Material/Source estimation solver) finished! 
============================================================
